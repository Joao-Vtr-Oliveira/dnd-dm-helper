<div class="max-w-5xl mx-auto px-4 py-6 space-y-6">
  <section class="flex flex-col md:flex-row md:items-center justify-between gap-4">
    <div>
      <div class="text-xs uppercase tracking-wider opacity-60">Data atual do mundo</div>
      <div class="text-lg font-semibold">
        {{ current().day }} de {{ seasonLabel() }} • Ano {{ current().year }}
      </div>
      <div class="text-sm opacity-70">
        {{ weekdayLabelCurrent() }} • {{ timeLabelCurrent() }} • {{ moonCurrent().label }}
      </div>
    </div>

    <div class="flex flex-col items-stretch md:items-end gap-2">
      <div class="flex flex-wrap gap-2 justify-end">
        <button
          class="h-9 px-3 rounded-2xl bg-white/10 hover:bg-white/15 border border-white/10 text-xs"
          (click)="changeSeason(-1)"
        >
          ◀ Estação
        </button>
        <button
          class="h-9 px-3 rounded-2xl bg-white/10 hover:bg-white/15 border border-white/10 text-xs"
          (click)="changeSeason(1)"
        >
          Estação ▶
        </button>

        <button
          class="h-9 px-3 rounded-2xl bg-white/10 hover:bg-white/15 border border-white/10 text-xs"
          (click)="changeDay(-1)"
        >
          -1 dia
        </button>
        <button
          class="h-9 px-3 rounded-2xl bg-white/10 hover:bg-white/15 border border-white/10 text-xs"
          (click)="changeDay(1)"
        >
          +1 dia
        </button>

        <button
          class="h-9 px-3 rounded-2xl bg-emerald-500/20 hover:bg-emerald-500/30 border border-emerald-400/40 text-xs"
          (click)="goToday()"
        >
          Reset ano 1000
        </button>
      </div>

		<div
			class="inline-flex items-center gap-2 rounded-2xl bg-black/40 border border-white/10 px-3 py-2 text-sm"
		>
			<span class="text-xs uppercase tracking-wider opacity-70">Hora atual</span>

			<button
				class="h-7 px-2 inline-flex items-center justify-center rounded-xl bg-white/5 hover:bg-white/10 border border-white/10 text-xs"
				(click)="changeHour(-1)"
			>
				-1h
			</button>

			<div class="text-lg font-semibold tabular-nums">
				{{ timeLabelCurrent() }}
			</div>

			<button
				class="h-7 px-2 inline-flex items-center justify-center rounded-xl bg-white/5 hover:bg-white/10 border border-white/10 text-xs"
				(click)="changeHour(1)"
			>
				+1h
			</button>

			<button
				class="h-7 px-3 inline-flex items-center justify-center rounded-xl bg-emerald-500/20 hover:bg-emerald-500/30 border border-emerald-400/40 text-xs"
				(click)="resetTime()"
			>
				Reset 05:00
			</button>
		</div>


    </div>
  </section>

  <section
    class="rounded-2xl bg-white/5 border border-white/10 p-4 flex flex-col md:flex-row md:items-end gap-3"
  >
    <div class="flex-1">
      <div class="text-xs uppercase tracking-wider opacity-60">Ir para data</div>

      <div class="mt-2 grid grid-cols-1 sm:grid-cols-4 gap-2">
        <label class="text-xs col-span-1">
          <span class="opacity-70">Ano</span>
          <input
            type="number"
            class="mt-1 w-full rounded-xl bg-black/20 border border-white/10 px-3 py-2 text-sm"
            [(ngModel)]="jumpYearInput"
          />
        </label>

        <label class="text-xs col-span-2 sm:col-span-2">
          <span class="opacity-70">Estação</span>
          <select
            class="mt-1 w-full rounded-xl bg-black/20 border border-white/10 px-3 py-2 text-sm"
            [(ngModel)]="jumpSeasonInput"
          >
            <option value="spring">Primavera</option>
            <option value="summer">Verão</option>
            <option value="autumn">Outono</option>
            <option value="winter">Inverno</option>
          </select>
        </label>

        <label class="text-xs col-span-1">
          <span class="opacity-70">Dia (1–30)</span>
          <input
            type="number"
            min="1"
            max="30"
            class="mt-1 w-full rounded-xl bg-black/20 border border-white/10 px-3 py-2 text-sm"
            [(ngModel)]="jumpDayInput"
          />
        </label>
      </div>
    </div>

    <button
      class="h-10 px-4 rounded-2xl bg-white/10 hover:bg-white/15 border border-white/10 text-sm md:self-end"
      (click)="goToDate()"
    >
      Ir
    </button>
  </section>

  <section class="rounded-2xl bg-white/5 border border-white/10 p-4">
    <div class="flex items-center justify-between mb-3">
      <h3 class="text-sm font-semibold opacity-90">
        {{ seasonLabel() }} • Ano {{ current().year }}
      </h3>
    </div>

    <div class="grid grid-cols-7 text-xs font-semibold uppercase tracking-wider opacity-60 mb-2">
      @for (w of weekdayHeaders; track $index) {
        <div class="text-center">{{ w }}</div>
      }
    </div>

    <div class="space-y-1">
      @for (week of weeks(); track $index) {
        <div class="grid grid-cols-7 gap-1">
          @for (cell of week; track $index) {
            @if (cell === null) {
              <div class="h-12"></div>
            } @else {
              <button
                type="button"
                class="h-16 rounded-xl border text-sm flex flex-col items-center justify-center gap-1 transition
                       border-white/10 bg-black/20 hover:bg-white/10"
                [class.border-emerald-400/70]="isSelected(cell)"
                [class.bg-emerald-500/25]="isSelected(cell)"
                [class.ring-2]="isCurrent(cell)"
                [class.ring-emerald-300/80]="isCurrent(cell)"
                (click)="selectCell(cell)"
              >
                <div class="text-base leading-none">
                  {{ cell.day }}
                </div>

                <div class="flex items-center gap-1 text-xs">
                  <span>{{ moonIcon(cell.moon.phase) }}</span>

                  @if (cell.events.length > 0) {
                    <span class="w-1.5 h-1.5 rounded-full bg-amber-300 inline-block" title="Evento"></span>
                  }
                </div>
              </button>
            }
          }
        </div>
      }
    </div>

    <div class="mt-3 flex flex-wrap gap-4 text-xs opacity-70">
      <div class="flex items-center gap-2">
        <span class="inline-block w-3 h-3 rounded-xl border border-emerald-300 ring-2 ring-emerald-300/80"></span>
        Dia atual
      </div>

      <div class="flex items-center gap-2">
        <span class="inline-block w-3 h-3 rounded-xl bg-emerald-500/70 border border-emerald-400/70"></span>
        Dia selecionado
      </div>

      <div class="flex items-center gap-2">
        <span class="inline-block w-3 h-3 rounded-full bg-amber-300"></span>
        Possui evento
      </div>
    </div>
  </section>

  <section class="rounded-2xl bg-white/5 border border-white/10 p-4 space-y-3">
    <div>
      <div class="text-xs uppercase tracking-wider opacity-60">Dia selecionado</div>
      <div class="text-lg font-semibold">
        {{ selected().day }} de {{ seasonLabel() }} • Ano {{ selected().year }}
      </div>
      <div class="text-sm opacity-70">
        {{ weekdayLabelSelected() }} • {{ timeLabelSelected() }} • {{ moonSelected().label }}
      </div>
    </div>

    <div class="border-top border-white/10 pt-3">
      @if (eventsSelected().length === 0) {
        <div class="text-sm opacity-70">
          Nenhum evento especial neste dia.
        </div>
      } @else {
        <div class="space-y-2">
          @for (ev of eventsSelected(); track ev.id) {
            <article class="rounded-xl bg-black/30 border border-white/10 p-3">
              <div class="text-sm font-semibold">
                {{ ev.title }}
                @if (ev.deity) {
                  <span class="text-xs opacity-70">• {{ ev.deity }}</span>
                }
              </div>

              <p class="mt-1 text-xs opacity-80">
                {{ ev.description }}
              </p>

              @if (ev.tags?.length) {
                <div class="mt-2 flex flex-wrap gap-1">
                  @for (tag of ev.tags; track tag) {
                    <span
                      class="px-2 py-0.5 rounded-full bg-white/10 text-[11px] uppercase tracking-wide opacity-80"
                    >
                      {{ tag }}
                    </span>
                  }
                </div>
              }
            </article>
          }
        </div>
      }
    </div>
  </section>
</div>
